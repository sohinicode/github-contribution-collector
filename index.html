<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>GitHub Contribution Collector</title>

<script src="https://cdn.tailwindcss.com"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&display=swap');

body {
    background-color: #0d1117;
    color: #c9d1d9;
    font-family: 'Fira Code', monospace;
    margin: 0;
    overflow: hidden;
}

#game-container {
    width: 100vw;
    height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

canvas {
    border: 2px solid #30363d;
    border-radius: 6px;
    background-color: #010409;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
}

.stats {
    display: flex;
    gap: 20px;
    margin-bottom: 10px;
    font-size: 1.2rem;
}

.commit-text { color: #39d353; }

#overlay {
    position: absolute;
    inset: 0;
    background: rgba(13, 17, 23, 0.85);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 10;
}

.btn {
    background-color: #238636;
    color: white;
    padding: 10px 24px;
    border-radius: 6px;
    font-weight: bold;
    cursor: pointer;
    border: none;
    margin-top: 20px;
}

.btn:hover {
    background-color: #2ea043;
}

.controls-hint {
    margin-top: 15px;
    font-size: 0.8rem;
    color: #8b949e;
}
</style>
</head>

<body>

<div id="game-container">
    <div class="stats">
        <div>Commits: <span id="score" class="commit-text">0</span></div>
        <div>Streak: <span id="streak" class="commit-text">0</span></div>
    </div>

    <canvas id="gameCanvas" width="400" height="500"></canvas>

    <div id="overlay">
        <h1 id="title" class="text-4xl font-bold mb-4">Contribution Collector</h1>
        <p id="message" class="text-center max-w-md mb-4 px-4">
            Catch green commits. Avoid red bugs.
        </p>
        <button id="start-btn" class="btn">Start Deployment</button>
        <p class="controls-hint">Arrows / A-D to move â€¢ ESC to pause</p>
    </div>
</div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

const scoreEl = document.getElementById("score");
const streakEl = document.getElementById("streak");
const overlay = document.getElementById("overlay");
const startBtn = document.getElementById("start-btn");
const titleEl = document.getElementById("title");
const messageEl = document.getElementById("message");

let score = 0;
let streak = 0;
let gameActive = false;
let isPaused = false;

const player = {
    x: 175,
    y: 460,
    width: 50,
    height: 10,
    speed: 7,
    dx: 0
};

let items = [];
let frameCount = 0;

const keys = {};

document.addEventListener("keydown", e => {
    keys[e.code] = true;

    if (e.code === "Escape" && gameActive) {
        pauseGame();
    }
});

document.addEventListener("keyup", e => {
    keys[e.code] = false;
});

function spawnItem() {
    const isCommit = Math.random() < 0.75;
    items.push({
        x: Math.random() * 380,
        y: -20,
        size: 20,
        type: isCommit ? "commit" : "bug",
        speed: 3 + score / 20
    });
}

function startOrResumeGame() {
    if (isPaused) {
        gameActive = true;
        isPaused = false;
        overlay.style.display = "none";
        requestAnimationFrame(update);
        return;
    }

    score = 0;
    streak = 0;
    items = [];
    frameCount = 0;
    player.x = 175;

    scoreEl.textContent = score;
    streakEl.textContent = streak;

    gameActive = true;
    overlay.style.display = "none";
    startBtn.textContent = "Start Deployment";

    requestAnimationFrame(update);
}

function pauseGame() {
    gameActive = false;
    isPaused = true;
    overlay.style.display = "flex";
    titleEl.textContent = "Game Paused";
    messageEl.innerHTML = "Press <b>Resume</b> to continue";
    startBtn.textContent = "Resume Game";
}

function gameOver() {
    gameActive = false;
    overlay.style.display = "flex";
    titleEl.textContent = "Build Failed!";
    messageEl.innerHTML = `
        Final Commits: <span class="commit-text">${score}</span><br>
        Best Streak: ${streak}
    `;
    startBtn.textContent = "Retry Deployment";
}

function update() {
    if (!gameActive) return;

    if (keys.ArrowLeft || keys.KeyA) player.dx = -player.speed;
    else if (keys.ArrowRight || keys.KeyD) player.dx = player.speed;
    else player.dx = 0;

    player.x += player.dx;
    player.x = Math.max(0, Math.min(350, player.x));

    frameCount++;
    if (frameCount % 60 === 0) spawnItem();

    ctx.clearRect(0, 0, 400, 500);

    ctx.fillStyle = "#58a6ff";
    ctx.fillRect(player.x, player.y, player.width, player.height);

    for (let i = items.length - 1; i >= 0; i--) {
        const item = items[i];
        item.y += item.speed;

        if (item.type === "commit") {
            ctx.fillStyle = "#39d353";
            ctx.fillRect(item.x, item.y, item.size, item.size);
        } else {
            ctx.strokeStyle = "#f85149";
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(item.x, item.y);
            ctx.lineTo(item.x + item.size, item.y + item.size);
            ctx.moveTo(item.x + item.size, item.y);
            ctx.lineTo(item.x, item.y + item.size);
            ctx.stroke();
        }

        if (
            item.y + item.size > player.y &&
            item.x < player.x + player.width &&
            item.x + item.size > player.x
        ) {
            if (item.type === "commit") {
                score++;
                streak++;
                scoreEl.textContent = score;
                streakEl.textContent = streak;
                items.splice(i, 1);
            } else {
                gameOver();
                return;
            }
        } else if (item.y > 500) {
            if (item.type === "commit") {
                streak = 0;
                streakEl.textContent = streak;
            }
            items.splice(i, 1);
        }
    }

    requestAnimationFrame(update);
}

startBtn.addEventListener("click", startOrResumeGame);
</script>

</body>
</html>
